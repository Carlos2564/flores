<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0d1b2a">
    <meta name="description" content="Un jard√≠n m√°gico de flores ne√≥n para Genesis Aracely">
    <meta name="apple-mobile-web-app-title" content="Genesis Garden">
    <title>Para Genesis Aracely ‚ú®</title>
    <link rel="stylesheet" href="flores-genesis.css">
    <style>
        /* Prevenir el bouncing en iOS */
        html, body {
            overscroll-behavior-y: none;
            -webkit-overflow-scrolling: touch;
        }
    </style>
</head>
<body>
    <!-- Secci√≥n principal del jard√≠n m√°gico -->
    <section class="garden-container">
        <!-- Part√≠culas de luz flotantes -->
        <section class="particles-section"></section>
        
        <!-- Ondas de energ√≠a de fondo -->
        <section class="energy-waves"></section>
        
        <!-- Contenedor de flores principales -->
        <section class="flowers-main-section"></section>
        
        <!-- Mensaje dedicado -->
        <section class="dedication-section">
            <h1 class="main-title">Para Genesis Aracely</h1>
            <p class="subtitle">Un jard√≠n eterno de luz y color para alguien extraordinario</p>
            <section class="interactive-controls">
                <button class="control-btn" data-action="bloom">üå∏ Florecer</button>
                <button class="control-btn" data-action="sparkle">‚ú® Brillar</button>
                <button class="control-btn" data-action="dance">üíÉ Danzar</button>
                <button class="control-btn" data-action="rainbow">üåà Arco√≠ris</button>
            </section>
        </section>
        
        <!-- Panel de Juego -->
        <section class="game-panel">
            <section class="game-stats">
                <article class="stat-item">
                    <span class="stat-icon">üå∏</span>
                    <span class="stat-value" data-stat="flowers">0</span>
                    <span class="stat-label">Flores</span>
                </article>
                <article class="stat-item">
                    <span class="stat-icon">‚≠ê</span>
                    <span class="stat-value" data-stat="points">0</span>
                    <span class="stat-label">Puntos</span>
                </article>
                <article class="stat-item">
                    <span class="stat-icon">üèÜ</span>
                    <span class="stat-value" data-stat="achievements">0</span>
                    <span class="stat-label">Logros</span>
                </article>
            </section>
            <button class="game-toggle-btn">üéÆ Modo Juego</button>
        </section>
        
        <!-- Bot√≥n flotante visible siempre -->
        <button class="floating-game-btn">üéÆ</button>
        
        <!-- Panel de Logros -->
        <section class="achievements-panel">
            <h3 class="achievements-title">üèÜ Logros Desbloqueados</h3>
            <section class="achievements-list"></section>
        </section>
        
        <!-- Notificaciones de Juego -->
        <section class="game-notifications"></section>
        
        <!-- Combo Meter -->
        <section class="combo-meter">
            <span class="combo-text">Combo: <span class="combo-value">0</span>x</span>
            <section class="combo-bar">
                <section class="combo-fill"></section>
            </section>
        </section>
        
        <!-- Estrellas de fondo -->
        <section class="stars-section"></section>
    </section>

    <script>
        // ==================== CONFIGURACI√ìN GLOBAL ====================
        const CONFIG = {
            flowerCount: 15,
            particleCount: 100,
            starCount: 150,
            colors: {
                // Colores muy suavizados - tonos pastel suaves
                neon: ['#b380e6', '#80b3e6', '#e6e6b3', '#e6b3d9', '#b3e6d9', '#e6c2b3', '#8099e6'],
                pastel: ['#e6c2d9', '#c2d9e6', '#d9e6c2', '#e6d9c2', '#d9c2e6']
            },
            // Detecci√≥n de dispositivo
            isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
            isTouch: 'ontouchstart' in window || navigator.maxTouchPoints > 0,
            // Sistema de juego
            gameMode: false,
            points: 0,
            flowersCollected: 0,
            combo: 0,
            comboTimer: null,
            achievements: []
        };

        // Ajustar configuraci√≥n seg√∫n dispositivo
        if (CONFIG.isMobile) {
            CONFIG.flowerCount = 10;
            CONFIG.particleCount = 50;
            CONFIG.starCount = 80;
        }

        // Prevenir zoom en dispositivos m√≥viles
        document.addEventListener('touchmove', function(e) {
            if (e.scale !== 1) { e.preventDefault(); }
        }, { passive: false });

        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });

        // ==================== SISTEMA DE LOGROS ====================
        const ACHIEVEMENTS = {
            firstFlower: { id: 'first', name: 'Primera Flor', desc: 'Recolecta tu primera flor', icon: 'üå∏', requirement: 1 },
            collector: { id: 'collector', name: 'Coleccionista', desc: 'Recolecta 10 flores', icon: 'üå∫', requirement: 10 },
            master: { id: 'master', name: 'Maestro Jardinero', desc: 'Recolecta 50 flores', icon: 'üåª', requirement: 50 },
            comboStarter: { id: 'combo5', name: 'Combo Inicial', desc: 'Consigue un combo de 5x', icon: 'üî•', requirement: 5 },
            comboMaster: { id: 'combo10', name: 'Combo Maestro', desc: 'Consigue un combo de 10x', icon: '‚ö°', requirement: 10 },
            pointHunter: { id: 'points100', name: 'Cazador de Puntos', desc: 'Alcanza 100 puntos', icon: '‚≠ê', requirement: 100 },
            pointMaster: { id: 'points500', name: 'Maestro de Puntos', desc: 'Alcanza 500 puntos', icon: 'üí´', requirement: 500 },
            speedDemon: { id: 'speed', name: 'Velocista', desc: 'Recolecta 5 flores en 3 segundos', icon: 'üí®', requirement: 5 },
            dedicated: { id: 'dedicated', name: 'Dedicado', desc: 'Juega durante 2 minutos', icon: 'üíñ', requirement: 120 },
            rainbowLover: { id: 'rainbow', name: 'Amante del Arco√≠ris', desc: 'Activa el modo arco√≠ris', icon: 'üåà', requirement: 1 }
        };

        // ==================== CLASE FLOWER - Flores Din√°micas ====================
        class Flower {
            constructor(x, y, size, color) {
                this.x = x;
                this.y = y;
                this.size = size;
                this.color = color;
                this.rotation = Math.random() * 360;
                this.petalCount = Math.floor(Math.random() * 4) + 5; // 5-8 p√©talos
                this.element = null;
                this.bloomProgress = 0;
                this.collected = false;
                this.rarity = this.calculateRarity();
                this.points = this.calculatePoints();
                this.create();
            }

            // Calcular rareza de la flor
            calculateRarity() {
                const rand = Math.random();
                if (rand > 0.95) return 'legendary'; // 5%
                if (rand > 0.85) return 'epic';      // 10%
                if (rand > 0.65) return 'rare';      // 20%
                return 'common';                      // 65%
            }

            // Calcular puntos seg√∫n rareza
            calculatePoints() {
                const basePoints = {
                    common: 10,
                    rare: 25,
                    epic: 50,
                    legendary: 100
                };
                return basePoints[this.rarity];
            }

            // Crear estructura HTML de la flor
            create() {
                const flower = document.createElement('article');
                flower.className = `flower flower-${this.rarity}`;
                flower.style.left = this.x + '%';
                flower.style.top = this.y + '%';
                flower.style.setProperty('--flower-size', this.size + 'px');
                flower.style.setProperty('--flower-color', this.color);
                flower.style.setProperty('--rotation', this.rotation + 'deg');

                // Indicador de rareza
                if (this.rarity !== 'common') {
                    const rarityBadge = document.createElement('span');
                    rarityBadge.className = 'rarity-badge';
                    const rarityIcons = {
                        rare: 'üíé',
                        epic: '‚≠ê',
                        legendary: 'üëë'
                    };
                    rarityBadge.textContent = rarityIcons[this.rarity];
                    flower.appendChild(rarityBadge);
                }

                // Centro de la flor
                const center = document.createElement('section');
                center.className = 'flower-center';
                flower.appendChild(center);

                // Crear p√©talos
                const petalsContainer = document.createElement('section');
                petalsContainer.className = 'petals-container';
                
                for (let i = 0; i < this.petalCount; i++) {
                    const petal = document.createElement('span');
                    petal.className = 'petal';
                    petal.style.setProperty('--petal-index', i);
                    petal.style.setProperty('--petal-total', this.petalCount);
                    petalsContainer.appendChild(petal);
                }
                
                flower.appendChild(petalsContainer);

                // Tallo con hojas
                const stem = document.createElement('section');
                stem.className = 'stem';
                
                const leaf1 = document.createElement('span');
                leaf1.className = 'leaf leaf-left';
                const leaf2 = document.createElement('span');
                leaf2.className = 'leaf leaf-right';
                
                stem.appendChild(leaf1);
                stem.appendChild(leaf2);
                flower.appendChild(stem);

                // Aura brillante
                const aura = document.createElement('section');
                aura.className = 'flower-aura';
                flower.appendChild(aura);

                this.element = flower;
                
                // Interactividad
                this.addInteractivity();
            }

            // Agregar eventos interactivos (soporte t√°ctil y mouse)
            addInteractivity() {
                // Eventos para desktop
                this.element.addEventListener('mouseenter', () => {
                    if (!CONFIG.isTouch && !this.collected) {
                        this.element.classList.add('flower-hover');
                        if (!CONFIG.gameMode) {
                            this.createSparkles();
                        }
                    }
                });

                this.element.addEventListener('mouseleave', () => {
                    if (!CONFIG.isTouch) {
                        this.element.classList.remove('flower-hover');
                    }
                });

                // Eventos para m√≥vil/t√°ctil
                this.element.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    if (!this.collected) {
                        this.element.classList.add('flower-hover');
                        if (CONFIG.gameMode) {
                            this.collect();
                        } else {
                            this.createSparkles();
                            this.bloom();
                        }
                    }
                }, { passive: false });

                this.element.addEventListener('touchend', () => {
                    setTimeout(() => {
                        this.element.classList.remove('flower-hover');
                    }, 500);
                });

                // Click funciona en ambos
                this.element.addEventListener('click', (e) => {
                    if (!CONFIG.isTouch && !this.collected) {
                        if (CONFIG.gameMode) {
                            this.collect();
                        } else {
                            this.bloom();
                        }
                    }
                });
            }

            // Efecto de florecimiento
            bloom() {
                this.element.classList.add('blooming');
                setTimeout(() => {
                    this.element.classList.remove('blooming');
                }, 2000);
            }

            // Recolectar flor (modo juego)
            collect() {
                if (this.collected || !CONFIG.gameMode) return;
                
                this.collected = true;
                this.element.classList.add('collected');
                
                // Actualizar estad√≠sticas
                window.gameManager.addPoints(this.points);
                window.gameManager.incrementCombo();
                window.gameManager.collectFlower();
                
                // Mostrar puntos flotantes
                this.showFloatingPoints();
                
                // Crear efecto de recolecci√≥n
                this.createCollectionEffect();
                
                // Regenerar flor despu√©s de un tiempo
                setTimeout(() => {
                    this.respawn();
                }, 3000);
            }

            // Mostrar puntos flotantes
            showFloatingPoints() {
                const points = document.createElement('span');
                points.className = 'floating-points';
                points.textContent = `+${this.points}`;
                points.style.left = '50%';
                points.style.top = '50%';
                this.element.appendChild(points);
                
                setTimeout(() => points.remove(), 1500);
            }

            // Efecto de recolecci√≥n
            createCollectionEffect() {
                for (let i = 0; i < 12; i++) {
                    const particle = document.createElement('span');
                    particle.className = 'collection-particle';
                    particle.style.setProperty('--angle', (360 / 12 * i) + 'deg');
                    particle.style.background = this.color;
                    this.element.appendChild(particle);
                    
                    setTimeout(() => particle.remove(), 800);
                }
            }

            // Regenerar flor
            respawn() {
                this.collected = false;
                this.element.classList.remove('collected');
                this.element.classList.add('respawning');
                
                setTimeout(() => {
                    this.element.classList.remove('respawning');
                }, 1000);
            }

            // Crear destellos al interactuar
            createSparkles() {
                const sparkleCount = CONFIG.isMobile ? 3 : 5;
                for (let i = 0; i < sparkleCount; i++) {
                    setTimeout(() => {
                        const sparkle = document.createElement('span');
                        sparkle.className = 'sparkle';
                        sparkle.style.left = (Math.random() * 100) + '%';
                        sparkle.style.top = (Math.random() * 100) + '%';
                        this.element.appendChild(sparkle);
                        
                        setTimeout(() => sparkle.remove(), 1000);
                    }, i * 100);
                }
            }
        }

        // ==================== GAME MANAGER - Sistema de Juego ====================
        class GameManager {
            constructor() {
                this.points = 0;
                this.flowersCollected = 0;
                this.combo = 0;
                this.comboTimer = null;
                this.achievements = new Set();
                this.gameActive = false;
                this.startTime = null;
                this.speedCollectionStart = null;
                this.speedCollectionCount = 0;
                this.setupUI();
            }

            // Configurar interfaz de usuario
            setupUI() {
                this.statsElements = {
                    points: document.querySelector('[data-stat="points"]'),
                    flowers: document.querySelector('[data-stat="flowers"]'),
                    achievements: document.querySelector('[data-stat="achievements"]')
                };
                this.comboValue = document.querySelector('.combo-value');
                this.comboFill = document.querySelector('.combo-fill');
            }

            // Activar/desactivar modo juego
            toggleGameMode() {
                this.gameActive = !this.gameActive;
                CONFIG.gameMode = this.gameActive;
                
                const panel = document.querySelector('.game-panel');
                const comboMeter = document.querySelector('.combo-meter');
                const achievementsPanel = document.querySelector('.achievements-panel');
                const floatingBtn = document.querySelector('.floating-game-btn');
                
                if (this.gameActive) {
                    panel.classList.add('active');
                    comboMeter.classList.add('active');
                    floatingBtn.classList.add('active');
                    document.body.classList.add('game-mode-active');
                    this.startTime = Date.now();
                    this.checkDedicationAchievement();
                    this.showNotification('¬°Modo Juego Activado! üéÆ', 'Haz clic en las flores para recolectarlas');
                } else {
                    panel.classList.remove('active');
                    comboMeter.classList.remove('active');
                    floatingBtn.classList.remove('active');
                    achievementsPanel.classList.remove('show');
                    document.body.classList.remove('game-mode-active');
                    this.showNotification('Modo Juego Desactivado', 'Vuelve cuando quieras jugar üíñ');
                }
            }

            // Agregar puntos
            addPoints(points) {
                const multiplier = Math.min(this.combo, 10);
                const totalPoints = points * (1 + multiplier * 0.1);
                this.points += Math.floor(totalPoints);
                this.updateStats();
                this.checkPointsAchievements();
            }

            // Recolectar flor
            collectFlower() {
                this.flowersCollected++;
                this.updateStats();
                this.checkFlowerAchievements();
                this.checkSpeedAchievement();
                
                // Vibraci√≥n en m√≥viles
                if (navigator.vibrate && CONFIG.isMobile) {
                    navigator.vibrate(30);
                }
            }

            // Incrementar combo
            incrementCombo() {
                this.combo++;
                this.updateCombo();
                this.checkComboAchievements();
                
                // Reset timer
                clearTimeout(this.comboTimer);
                this.comboTimer = setTimeout(() => {
                    this.resetCombo();
                }, 2000);
            }

            // Resetear combo
            resetCombo() {
                if (this.combo > 0) {
                    this.combo = 0;
                    this.updateCombo();
                }
            }

            // Actualizar visualizaci√≥n de combo
            updateCombo() {
                this.comboValue.textContent = this.combo;
                const fillPercent = Math.min((this.combo / 10) * 100, 100);
                this.comboFill.style.width = fillPercent + '%';
                
                // Cambiar color seg√∫n combo
                const comboMeter = document.querySelector('.combo-meter');
                comboMeter.className = 'combo-meter active';
                if (this.combo >= 10) comboMeter.classList.add('mega');
                else if (this.combo >= 5) comboMeter.classList.add('super');
            }

            // Actualizar estad√≠sticas
            updateStats() {
                this.statsElements.points.textContent = this.points;
                this.statsElements.flowers.textContent = this.flowersCollected;
                this.statsElements.achievements.textContent = this.achievements.size;
            }

            // Desbloquear logro
            unlockAchievement(achievementKey) {
                if (this.achievements.has(achievementKey)) return;
                
                this.achievements.add(achievementKey);
                const achievement = ACHIEVEMENTS[achievementKey];
                
                this.showNotification(
                    `üèÜ ¬°Logro Desbloqueado!`,
                    `${achievement.icon} ${achievement.name}`,
                    'achievement'
                );
                
                this.addAchievementToPanel(achievement);
                this.updateStats();
                
                // Vibraci√≥n especial para logros
                if (navigator.vibrate && CONFIG.isMobile) {
                    navigator.vibrate([100, 50, 100, 50, 200]);
                }
            }

            // Agregar logro al panel
            addAchievementToPanel(achievement) {
                const list = document.querySelector('.achievements-list');
                const item = document.createElement('article');
                item.className = 'achievement-item';
                item.innerHTML = `
                    <span class="achievement-icon">${achievement.icon}</span>
                    <section class="achievement-info">
                        <strong>${achievement.name}</strong>
                        <small>${achievement.desc}</small>
                    </section>
                `;
                list.appendChild(item);
                
                // Mostrar panel temporalmente
                const panel = document.querySelector('.achievements-panel');
                panel.classList.add('show');
                setTimeout(() => {
                    if (!panel.matches(':hover')) {
                        panel.classList.remove('show');
                    }
                }, 5000);
            }

            // Verificar logros de flores
            checkFlowerAchievements() {
                if (this.flowersCollected >= 1) this.unlockAchievement('firstFlower');
                if (this.flowersCollected >= 10) this.unlockAchievement('collector');
                if (this.flowersCollected >= 50) this.unlockAchievement('master');
            }

            // Verificar logros de combo
            checkComboAchievements() {
                if (this.combo >= 5) this.unlockAchievement('comboStarter');
                if (this.combo >= 10) this.unlockAchievement('comboMaster');
            }

            // Verificar logros de puntos
            checkPointsAchievements() {
                if (this.points >= 100) this.unlockAchievement('pointHunter');
                if (this.points >= 500) this.unlockAchievement('pointMaster');
            }

            // Verificar logro de velocidad
            checkSpeedAchievement() {
                const now = Date.now();
                
                if (!this.speedCollectionStart) {
                    this.speedCollectionStart = now;
                    this.speedCollectionCount = 1;
                } else {
                    const elapsed = (now - this.speedCollectionStart) / 1000;
                    
                    if (elapsed <= 3) {
                        this.speedCollectionCount++;
                        if (this.speedCollectionCount >= 5) {
                            this.unlockAchievement('speedDemon');
                            this.speedCollectionStart = null;
                            this.speedCollectionCount = 0;
                        }
                    } else {
                        this.speedCollectionStart = now;
                        this.speedCollectionCount = 1;
                    }
                }
            }

            // Verificar logro de dedicaci√≥n
            checkDedicationAchievement() {
                setInterval(() => {
                    if (this.gameActive && this.startTime) {
                        const elapsed = (Date.now() - this.startTime) / 1000;
                        if (elapsed >= 120) {
                            this.unlockAchievement('dedicated');
                        }
                    }
                }, 1000);
            }

            // Mostrar notificaci√≥n
            showNotification(title, message, type = 'info') {
                const container = document.querySelector('.game-notifications');
                const notification = document.createElement('article');
                notification.className = `game-notification ${type}`;
                notification.innerHTML = `
                    <strong>${title}</strong>
                    <p>${message}</p>
                `;
                
                container.appendChild(notification);
                
                setTimeout(() => {
                    notification.classList.add('show');
                }, 10);
                
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            }
        }

        // ==================== CLASE PARTICLE - Part√≠culas Flotantes ====================
        class Particle {
            constructor() {
                this.element = document.createElement('span');
                this.element.className = 'particle';
                this.reset();
            }

            reset() {
                this.x = Math.random() * 100;
                this.y = Math.random() * 100;
                this.size = Math.random() * 4 + 2;
                this.speed = Math.random() * 2 + 1;
                this.color = CONFIG.colors.neon[Math.floor(Math.random() * CONFIG.colors.neon.length)];
                
                this.element.style.left = this.x + '%';
                this.element.style.top = this.y + '%';
                this.element.style.width = this.size + 'px';
                this.element.style.height = this.size + 'px';
                this.element.style.background = this.color;
                this.element.style.boxShadow = `0 0 ${this.size * 3}px ${this.color}`;
                this.element.style.setProperty('--particle-duration', this.speed + 's');
            }
        }

        // ==================== GESTOR PRINCIPAL ====================
        class GardenManager {
            constructor() {
                this.flowers = [];
                this.particles = [];
                this.isRainbowMode = false;
                this.init();
            }

            // Inicializar todo el jard√≠n
            init() {
                this.createFlowers();
                this.createParticles();
                this.createStars();
                this.createEnergyWaves();
                this.setupControls();
                this.startAnimationLoop();
            }

            // Crear todas las flores
            createFlowers() {
                const container = document.querySelector('.flowers-main-section');
                
                for (let i = 0; i < CONFIG.flowerCount; i++) {
                    const x = Math.random() * 90 + 5;
                    const y = Math.random() * 60 + 20;
                    const size = Math.random() * 40 + 60;
                    const color = CONFIG.colors.neon[Math.floor(Math.random() * CONFIG.colors.neon.length)];
                    
                    const flower = new Flower(x, y, size, color);
                    this.flowers.push(flower);
                    container.appendChild(flower.element);
                }
            }

            // Crear part√≠culas flotantes
            createParticles() {
                const container = document.querySelector('.particles-section');
                
                for (let i = 0; i < CONFIG.particleCount; i++) {
                    const particle = new Particle();
                    this.particles.push(particle);
                    container.appendChild(particle.element);
                }
            }

            // Crear estrellas de fondo
            createStars() {
                const container = document.querySelector('.stars-section');
                
                for (let i = 0; i < CONFIG.starCount; i++) {
                    const star = document.createElement('span');
                    star.className = 'star';
                    star.style.left = Math.random() * 100 + '%';
                    star.style.top = Math.random() * 100 + '%';
                    star.style.animationDelay = Math.random() * 3 + 's';
                    star.style.animationDuration = (Math.random() * 2 + 1) + 's';
                    container.appendChild(star);
                }
            }

            // Crear ondas de energ√≠a
            createEnergyWaves() {
                const container = document.querySelector('.energy-waves');
                
                for (let i = 0; i < 5; i++) {
                    const wave = document.createElement('section');
                    wave.className = 'wave';
                    wave.style.animationDelay = i * 0.5 + 's';
                    container.appendChild(wave);
                }
            }

            // Configurar controles interactivos (soporte t√°ctil completo)
            setupControls() {
                const buttons = document.querySelectorAll('.control-btn');
                
                buttons.forEach(btn => {
                    // Click para desktop
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        const action = e.target.dataset.action;
                        this.handleAction(action);
                        this.buttonFeedback(btn);
                    });

                    // Touch para m√≥vil
                    btn.addEventListener('touchstart', (e) => {
                        e.preventDefault();
                        btn.classList.add('btn-pressed');
                    }, { passive: false });

                    btn.addEventListener('touchend', (e) => {
                        e.preventDefault();
                        btn.classList.remove('btn-pressed');
                        const action = e.target.dataset.action;
                        this.handleAction(action);
                        this.buttonFeedback(btn);
                    }, { passive: false });

                    // Prevenir comportamiento por defecto
                    btn.addEventListener('touchmove', (e) => {
                        e.preventDefault();
                    }, { passive: false });
                });
                
                // Bot√≥n de modo juego (ambos botones)
                const gameToggle = document.querySelector('.game-toggle-btn');
                const floatingBtn = document.querySelector('.floating-game-btn');
                
                const toggleGame = () => {
                    window.gameManager.toggleGameMode();
                };
                
                gameToggle.addEventListener('click', toggleGame);
                floatingBtn.addEventListener('click', toggleGame);
                
                floatingBtn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    floatingBtn.classList.add('btn-pressed');
                }, { passive: false });
                
                floatingBtn.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    floatingBtn.classList.remove('btn-pressed');
                    toggleGame();
                }, { passive: false });
                
                // Panel de logros - mostrar/ocultar
                const achievementsPanel = document.querySelector('.achievements-panel');
                achievementsPanel.addEventListener('mouseenter', () => {
                    achievementsPanel.classList.add('show');
                });
                achievementsPanel.addEventListener('mouseleave', () => {
                    setTimeout(() => {
                        if (window.gameManager && !window.gameManager.gameActive) {
                            achievementsPanel.classList.remove('show');
                        }
                    }, 2000);
                });
            }

            // Feedback visual para botones
            buttonFeedback(btn) {
                btn.classList.add('btn-active');
                
                // Vibraci√≥n en dispositivos m√≥viles
                if (navigator.vibrate && CONFIG.isMobile) {
                    navigator.vibrate(50);
                }
                
                setTimeout(() => btn.classList.remove('btn-active'), 300);
            }

            // Manejar acciones de los botones
            handleAction(action) {
                switch(action) {
                    case 'bloom':
                        this.bloomAll();
                        break;
                    case 'sparkle':
                        this.sparkleAll();
                        break;
                    case 'dance':
                        this.danceAll();
                        break;
                    case 'rainbow':
                        this.toggleRainbow();
                        break;
                }
            }

            // Hacer florecer todas las flores
            bloomAll() {
                this.flowers.forEach((flower, index) => {
                    setTimeout(() => {
                        flower.bloom();
                    }, index * 100);
                });
            }

            // Crear destellos en todas las flores
            sparkleAll() {
                this.flowers.forEach((flower, index) => {
                    setTimeout(() => {
                        flower.createSparkles();
                    }, index * 50);
                });
            }

            // Hacer bailar todas las flores
            danceAll() {
                const container = document.querySelector('.flowers-main-section');
                container.classList.add('dancing');
                setTimeout(() => {
                    container.classList.remove('dancing');
                }, 5000);
            }

            // Activar/desactivar modo arco√≠ris
            toggleRainbow() {
                this.isRainbowMode = !this.isRainbowMode;
                document.body.classList.toggle('rainbow-mode', this.isRainbowMode);
                
                // Desbloquear logro de arco√≠ris
                if (this.isRainbowMode && window.gameManager) {
                    window.gameManager.unlockAchievement('rainbowLover');
                }
            }

            // Loop de animaci√≥n continua
            startAnimationLoop() {
                let hue = 0;
                
                setInterval(() => {
                    if (this.isRainbowMode) {
                        hue = (hue + 1) % 360;
                        document.documentElement.style.setProperty('--rainbow-hue', hue);
                    }
                }, 50);

                // Crear nuevas part√≠culas ocasionalmente
                setInterval(() => {
                    this.createMagicBurst();
                }, 3000);
            }

            // Crear explosi√≥n m√°gica de part√≠culas
            createMagicBurst() {
                const container = document.querySelector('.particles-section');
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                const burstCount = CONFIG.isMobile ? 6 : 10;
                
                for (let i = 0; i < burstCount; i++) {
                    setTimeout(() => {
                        const burst = document.createElement('span');
                        burst.className = 'magic-burst';
                        burst.style.left = x + '%';
                        burst.style.top = y + '%';
                        burst.style.setProperty('--burst-angle', (360 / burstCount * i) + 'deg');
                        burst.style.background = CONFIG.colors.neon[Math.floor(Math.random() * CONFIG.colors.neon.length)];
                        container.appendChild(burst);
                        
                        setTimeout(() => burst.remove(), 2000);
                    }, i * 50);
                }
            }
        }

        // ==================== INICIALIZACI√ìN ====================
        document.addEventListener('DOMContentLoaded', () => {
            // Inicializar gestor del jard√≠n
            const garden = new GardenManager();
            
            // Inicializar gestor de juego
            window.gameManager = new GameManager();
            
            // Mensaje de bienvenida en consola
            console.log('%c‚ú® Para Genesis Aracely ‚ú®', 'font-size: 24px; color: #ff00ff; text-shadow: 0 0 10px #ff00ff;');
            console.log('%cUn jard√≠n especial para una persona especial', 'font-size: 14px; color: #00ffff;');
            console.log('%cüéÆ ¬°Activa el Modo Juego para una experiencia interactiva!', 'font-size: 12px; color: #ffff99;');
            
            // Manejar cambio de orientaci√≥n en m√≥viles
            window.addEventListener('orientationchange', () => {
                setTimeout(() => {
                    location.reload();
                }, 300);
            });
            
            // Manejar resize para responsive
            let resizeTimer;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(() => {
                    // Ajustar tama√±os si es necesario
                    const isMobileNow = window.innerWidth <= 768;
                    if (isMobileNow !== CONFIG.isMobile) {
                        location.reload();
                    }
                }, 250);
            });
            
            // Prevenir scroll en m√≥viles
            if (CONFIG.isMobile) {
                document.body.addEventListener('touchmove', (e) => {
                    if (e.target === document.body) {
                        e.preventDefault();
                    }
                }, { passive: false });
            }
        });

        // Efecto de cursor personalizado (desktop y m√≥vil)
        if (!CONFIG.isMobile) {
            document.addEventListener('mousemove', (e) => {
                const trail = document.createElement('span');
                trail.className = 'cursor-trail';
                trail.style.left = e.pageX + 'px';
                trail.style.top = e.pageY + 'px';
                document.body.appendChild(trail);
                
                setTimeout(() => trail.remove(), 1000);
            });
        } else {
            // Rastro t√°ctil para m√≥viles
            document.addEventListener('touchmove', (e) => {
                if (e.touches.length > 0) {
                    const touch = e.touches[0];
                    const trail = document.createElement('span');
                    trail.className = 'cursor-trail';
                    trail.style.left = touch.pageX + 'px';
                    trail.style.top = touch.pageY + 'px';
                    document.body.appendChild(trail);
                    
                    setTimeout(() => trail.remove(), 1000);
                }
            }, { passive: true });

            // Habilitar cursor normal en m√≥viles
            document.body.style.cursor = 'auto';
        }
    </script>
</body>
</html>